#!/usr/sbin/python
import requests
import re
import webbrowser

print('''
=========== xBSSID Mapper ===========
######### Find AP by BSSID ##########
=====================================''')
while True:
  bssid = input("BSSID: ")
  bssid = bssid.upper()
  if not re.match("[0-9A-F]{2}([-:])[0-9A-F]{2}(\\1[0-9A-F]{2}){4}$", bssid):
    print("[!] Not valid MAC")
    continue
  bssid = bssid.replace(':', '')
  print("[*] MAC valid, locating..")
  web = requests.get("http://mobile.maps.yandex.net/cellid_location/?clid=1866854&lac=-1&cellid=-1&operatorid=null&countrycode=null&signalstrength=-1&wifinetworks=" + bssid +":-65&app=ymetro")
  if not 'error' in web.text:
    print("[*] AP located!")
    p = re.compile(r'\d+\.\d+')
    tags = p.findall(web.text)
    print("  Latitude: " + tags[1])
    print("  Longtitude: " + tags[2])
    if input("Open google maps? (y/n): ") == "y":
      webbrowser.open("https://www.google.com.ua/maps/?q=" + tags[1] + " " + tags[2])
  else:
    print("[!] AP not located or another error.")
